================================================================================
        QUICK START GUIDE - Email & SMS Communication System
================================================================================

🚀 GET STARTED IN 5 MINUTES!

================================================================================
STEP 1: SETUP DATABASE (2 minutes)
================================================================================

1. Open phpMyAdmin (http://localhost/phpmyadmin)
2. Click on your database: church_management_system
3. Click "Import" tab
4. Choose file: communication_system_setup.sql
5. Click "Go"

✅ You should see: "9 tables created successfully"

================================================================================
STEP 2: CONFIGURE EMAIL (2 minutes)
================================================================================

Open phpMyAdmin and run these queries:

-- FOR GMAIL USERS (Most Common):
UPDATE communication_settings SET setting_value = 'smtp.gmail.com' WHERE setting_key = 'smtp_host';
UPDATE communication_settings SET setting_value = '587' WHERE setting_key = 'smtp_port';
UPDATE communication_settings SET setting_value = 'YOUR_EMAIL@gmail.com' WHERE setting_key = 'smtp_username';
UPDATE communication_settings SET setting_value = 'YOUR_APP_PASSWORD' WHERE setting_key = 'smtp_password';
UPDATE communication_settings SET setting_value = 'Church Name' WHERE setting_key = 'email_from_name';
UPDATE communication_settings SET setting_value = 'YOUR_EMAIL@gmail.com' WHERE setting_key = 'email_from_address';

📧 How to get Gmail App Password:
   1. Go to: https://myaccount.google.com/apppasswords
   2. Enable 2-Factor Authentication first
   3. Create app password for "Mail"
   4. Copy the 16-character password
   5. Use it in the query above

================================================================================
STEP 3: TEST EMAIL (1 minute)
================================================================================

Create file: test_email.php

<?php
require_once 'db_connect.php';
require_once 'email_handler.php';

echo "Testing email...\n";
$result = sendEmail(
    'YOUR_TEST_EMAIL@gmail.com',
    'Test Email',
    'This is a test email from your Church Management System!',
    null
);

echo $result ? "✅ Email sent successfully!" : "❌ Email failed!";
?>

Run: http://localhost/Church_Management_System/admin_dashboard/Communication/test_email.php

================================================================================
STEP 4: (OPTIONAL) CONFIGURE SMS
================================================================================

Choose one SMS provider:

OPTION A - TWILIO (Global, Easy Setup):
--------------------------------------
1. Sign up: https://www.twilio.com
2. Get free trial credits
3. Copy: Account SID, Auth Token, Phone Number
4. Run these queries:

UPDATE communication_settings SET setting_value = 'twilio' WHERE setting_key = 'sms_provider';
UPDATE communication_settings SET setting_value = 'YOUR_ACCOUNT_SID' WHERE setting_key = 'sms_api_key';
UPDATE communication_settings SET setting_value = 'YOUR_AUTH_TOKEN' WHERE setting_key = 'sms_api_secret';
UPDATE communication_settings SET setting_value = '+1234567890' WHERE setting_key = 'sms_sender_id';

OPTION B - AFRICA'S TALKING (For Africa):
----------------------------------------
1. Sign up: https://africastalking.com
2. Get Username and API Key
3. Run these queries:

UPDATE communication_settings SET setting_value = 'africastalking' WHERE setting_key = 'sms_provider';
UPDATE communication_settings SET setting_value = 'YOUR_USERNAME' WHERE setting_key = 'sms_api_key';
UPDATE communication_settings SET setting_value = 'YOUR_API_KEY' WHERE setting_key = 'sms_api_secret';

================================================================================
STEP 5: START SENDING MESSAGES!
================================================================================

Your communication.html is ready to use!

You can now send messages to:
✅ All Members
✅ Youth Group
✅ Prayer Team
✅ Volunteers
✅ Custom Groups
✅ Individual Members
✅ Departments
✅ Ministries

Via:
✅ Email
✅ SMS
✅ Both!

================================================================================
HOW TO SEND YOUR FIRST MESSAGE
================================================================================

1. Open: communication.html in your browser
2. Fill in:
   - Message Type: Announcement
   - Audience: All Members
   - Message Title: "Test Message"
   - Message Content: "This is a test message from our new system!"
3. Select Delivery Channels: Email (or SMS if configured)
4. Click "Send Now"

✅ Done! Check your database:
   SELECT * FROM messages ORDER BY created_at DESC LIMIT 1;
   SELECT * FROM message_recipients ORDER BY created_at DESC LIMIT 10;

================================================================================
AUDIENCE OPTIONS EXPLAINED
================================================================================

audience_type: 'all'
→ Sends to ALL active members

audience_type: 'group', audience_value: 'Youth'
→ Sends to members where church_group = 'Youth'

audience_type: 'ministry', audience_value: 'Pastor'
→ Sends to members where leadership_role = 'Pastor'

audience_type: 'individual', member_ids: [1, 2, 3]
→ Sends to specific members

audience_type: 'custom_group', group_id: 1
→ Sends to members in message group #1

================================================================================
CHECKING YOUR MEMBERS DATA
================================================================================

Make sure your members have email/phone:

SELECT 
    COUNT(*) as total_members,
    COUNT(email) as members_with_email,
    COUNT(phone) as members_with_phone
FROM members 
WHERE status = 'active';

If members don't have email/phone, update them:

UPDATE members SET email = 'member@email.com' WHERE member_id = 1;
UPDATE members SET phone = '+1234567890' WHERE member_id = 1;

================================================================================
TROUBLESHOOTING
================================================================================

PROBLEM: "No recipients found"
SOLUTION: 
- Check members have status = 'active'
- Verify members have email or phone filled
- Run: SELECT * FROM members WHERE status = 'active';

PROBLEM: Email not sending
SOLUTION:
- Verify SMTP credentials
- Check you used Gmail App Password (not regular password)
- Try port 465 instead of 587
- Check: SELECT * FROM email_logs WHERE status = 'failed';

PROBLEM: SMS not sending
SOLUTION:
- Verify SMS provider credentials
- Check you have credits/balance
- Ensure phone numbers start with + (e.g., +1234567890)
- Check: SELECT * FROM sms_logs WHERE status = 'failed';

PROBLEM: Database connection error
SOLUTION:
- Verify db_connect.php has correct credentials
- Check XAMPP MySQL is running
- Verify database name is correct

================================================================================
MONITORING YOUR MESSAGES
================================================================================

-- View all sent messages
SELECT * FROM messages ORDER BY created_at DESC;

-- View delivery status
SELECT 
    delivery_channel,
    delivery_status,
    COUNT(*) as count
FROM message_recipients
GROUP BY delivery_channel, delivery_status;

-- View failed emails
SELECT * FROM email_logs WHERE status = 'failed';

-- View failed SMS
SELECT * FROM sms_logs WHERE status = 'failed';

-- Check recent activity
SELECT 
    m.title,
    m.total_recipients,
    m.total_sent,
    m.total_failed,
    m.sent_at
FROM messages m
ORDER BY m.created_at DESC
LIMIT 10;

================================================================================
CREATING CUSTOM MESSAGE GROUPS
================================================================================

Example: Create "Young Adults" group

1. Create the group:
INSERT INTO message_groups (group_name, group_type, description)
VALUES ('Young Adults', 'static', 'Ages 18-35');

2. Add members to group:
INSERT INTO message_group_members (group_id, member_id)
SELECT 1, member_id 
FROM members 
WHERE YEAR(CURDATE()) - YEAR(date_of_birth) BETWEEN 18 AND 35;

3. Send message to this group:
audience_type: 'custom_group'
group_id: 1

================================================================================
IMPORTANT NOTES
================================================================================

✅ Always test with a small group first
✅ Check spam folder if emails don't arrive
✅ SMS costs money - monitor usage
✅ Phone numbers must include country code (+)
✅ Backup your database regularly
✅ Keep API keys secure

================================================================================
FILES YOU HAVE
================================================================================

Database:
✅ communication_system_setup.sql - Database schema

Backend PHP:
✅ send_message.php - Main message sending API
✅ email_handler.php - Email sending functions
✅ sms_handler.php - SMS sending functions
✅ get_recipients.php - Get available recipients
✅ manage_groups.php - Manage custom groups

Documentation:
✅ COMMUNICATION_SYSTEM_GUIDE.md - Complete guide
✅ QUICK_SETUP_GUIDE.txt - This file

Frontend:
✅ communication.html - Your existing page (needs integration)

================================================================================
NEED HELP?
================================================================================

1. Read COMMUNICATION_SYSTEM_GUIDE.md for detailed documentation
2. Check error logs in phpMyAdmin
3. Test with simple examples first
4. Verify all settings are correct

================================================================================
YOU'RE ALL SET! 🎉
================================================================================

Your church can now communicate with members via Email and SMS!

Happy messaging! 📧📱
