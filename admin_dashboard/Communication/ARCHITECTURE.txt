═══════════════════════════════════════════════════════════════════════════════
  SOCIAL MEDIA TRACKING - SYSTEM ARCHITECTURE
═══════════════════════════════════════════════════════════════════════════════


📱 FRONTEND (communication.html)
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                         Communication Dashboard                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                      Social Media Tab                                 │   │
│  ├─────────────────────────────────────────────────────────────────────┤   │
│  │                                                                       │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌───────────┐  │   │
│  │  │  Facebook   │  │  Instagram  │  │  Twitter/X  │  │  YouTube  │  │   │
│  │  ├─────────────┤  ├─────────────┤  ├─────────────┤  ├───────────┤  │   │
│  │  │ Connected   │  │ Connected   │  │ Connected   │  │ Connected │  │   │
│  │  │             │  │             │  │             │  │           │  │   │
│  │  │ 4.2K ▲     │  │ 3.8K ▲     │  │ 2.1K ▲     │  │ 1.5K ▲   │  │   │
│  │  │ Followers   │  │ Followers   │  │ Followers   │  │ Subscribers│  │   │
│  │  │             │  │             │  │             │  │           │  │   │
│  │  │ 342         │  │ 512         │  │ 189         │  │ 12.4K     │  │   │
│  │  │ Engagement  │  │ Engagement  │  │ Engagement  │  │ Views     │  │   │
│  │  │             │  │             │  │             │  │           │  │   │
│  │  │ 8.1% Rate   │  │ 13.5% Rate  │  │ 9.0% Rate   │  │ 8.3% Growth│  │   │
│  │  │             │  │             │  │             │  │           │  │   │
│  │  │[New Post]   │  │[New Post]   │  │[New Post]   │  │[Upload]   │  │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └───────────┘  │   │
│  │                                                                       │   │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  Auto-refresh: Every 5 minutes                                              │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      │ JavaScript Fetch API
                                      ↓


⚙️ BACKEND API (social_media_api.php)
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                        REST API Endpoints                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  GET Endpoints:                                                              │
│  ├─ ?action=accounts     → Fetch all social media accounts & metrics        │
│  ├─ ?action=posts        → Fetch posts (all or by platform)                 │
│  └─ ?action=analytics    → Fetch 30-day historical data                     │
│                                                                              │
│  POST Endpoints:                                                             │
│  ├─ ?action=post         → Create new social media post                     │
│  ├─ ?action=update_metrics → Update platform metrics                        │
│  └─ ?action=connect      → Connect/disconnect platform                      │
│                                                                              │
│  PUT Endpoints:                                                              │
│  └─ ?action=post         → Update existing post                             │
│                                                                              │
│  DELETE Endpoints:                                                           │
│  └─ ?action=post&id=X    → Delete post by ID                                │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      │ PDO (Prepared Statements)
                                      ↓


🗄️ DATABASE LAYER (MySQL)
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                      church_management Database                              │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  social_media_accounts                                                 │ │
│  ├───────────────────────────────────────────────────────────────────────┤ │
│  │  - id (PK)                                                             │ │
│  │  - platform (facebook, instagram, twitter, youtube)                   │ │
│  │  - account_name                                                        │ │
│  │  - account_id                                                          │ │
│  │  - access_token (for OAuth)                                            │ │
│  │  - is_connected (0/1)                                                  │ │
│  │  - followers_count                                                     │ │
│  │  - engagement_count                                                    │ │
│  │  - engagement_rate (decimal)                                           │ │
│  │  - additional_metrics (JSON)                                           │ │
│  │  - last_updated (timestamp)                                            │ │
│  │  - created_at (timestamp)                                              │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  social_media_posts                                                    │ │
│  ├───────────────────────────────────────────────────────────────────────┤ │
│  │  - id (PK)                                                             │ │
│  │  - platform                                                            │ │
│  │  - post_type (text, image, video, reel, story, live, playlist)        │ │
│  │  - content                                                             │ │
│  │  - media_path                                                          │ │
│  │  - post_url                                                            │ │
│  │  - likes_count                                                         │ │
│  │  - comments_count                                                      │ │
│  │  - shares_count                                                        │ │
│  │  - views_count                                                         │ │
│  │  - status (draft, scheduled, published, failed)                       │ │
│  │  - scheduled_at                                                        │ │
│  │  - published_at                                                        │ │
│  │  - created_at                                                          │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐ │
│  │  social_media_analytics                                                │ │
│  ├───────────────────────────────────────────────────────────────────────┤ │
│  │  - id (PK)                                                             │ │
│  │  - platform                                                            │ │
│  │  - date (unique per platform)                                          │ │
│  │  - followers_count                                                     │ │
│  │  - new_followers                                                       │ │
│  │  - engagement_count                                                    │ │
│  │  - engagement_rate                                                     │ │
│  │  - posts_count                                                         │ │
│  │  - reach                                                               │ │
│  │  - impressions                                                         │ │
│  │  - created_at                                                          │ │
│  └───────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘


📊 DATA FLOW
═══════════════════════════════════════════════════════════════════════════════

1. PAGE LOAD
   ┌──────────┐      ┌──────────┐      ┌──────────┐      ┌──────────┐
   │  Browser │─────▶│JavaScript│─────▶│    API   │─────▶│ Database │
   │          │      │ (Fetch)  │      │   PHP    │      │  MySQL   │
   └──────────┘      └──────────┘      └──────────┘      └──────────┘
        ▲                                                       │
        │                    Response (JSON)                   │
        └───────────────────────────────────────────────────────┘


2. CREATE POST
   ┌──────────┐      ┌──────────┐      ┌──────────┐      ┌──────────┐
   │   User   │─────▶│  Modal   │─────▶│    API   │─────▶│ Database │
   │ Click Btn│      │  Form    │      │   POST   │      │  INSERT  │
   └──────────┘      └──────────┘      └──────────┘      └──────────┘
        ▲                                                       │
        │                Success Message                       │
        └───────────────────────────────────────────────────────┘


3. UPDATE METRICS
   ┌──────────┐      ┌──────────┐      ┌──────────┐      ┌──────────┐
   │  Manual  │─────▶│    API   │─────▶│ Database │─────▶│Analytics │
   │  or Cron │      │   POST   │      │  UPDATE  │      │  INSERT  │
   └──────────┘      └──────────┘      └──────────┘      └──────────┘


4. AUTO-REFRESH
   Every 5 minutes:
   ┌──────────┐      ┌──────────┐      ┌──────────┐
   │JavaScript│─────▶│    API   │─────▶│ Database │
   │setInterval     │   GET    │      │  SELECT  │
   └──────────┘      └──────────┘      └──────────┘


🔄 COMPONENT INTERACTION
═══════════════════════════════════════════════════════════════════════════════

                    ┌──────────────────────────┐
                    │    User Interface        │
                    │  (communication.html)    │
                    └────────────┬─────────────┘
                                 │
                    ┌────────────┴─────────────┐
                    │                          │
         ┌──────────▼────────┐      ┌─────────▼──────────┐
         │  Display Metrics  │      │   Create Posts     │
         │  (JavaScript)     │      │   (Modal Forms)    │
         └──────────┬────────┘      └─────────┬──────────┘
                    │                          │
                    └────────────┬─────────────┘
                                 │
                    ┌────────────▼─────────────┐
                    │    REST API Layer        │
                    │ (social_media_api.php)   │
                    └────────────┬─────────────┘
                                 │
                    ┌────────────▼─────────────┐
                    │   Database Layer         │
                    │ (3 Tables via PDO)       │
                    └──────────────────────────┘


🛠️ TESTING TOOLS
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│  test_social_api.php                                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│  - Database connection test                                                  │
│  - Table existence verification                                              │
│  - API endpoint testing                                                      │
│  - Sample data generation                                                    │
│  - View current data                                                         │
│  - Manual metrics update                                                     │
└─────────────────────────────────────────────────────────────────────────────┘


🔐 SECURITY LAYERS
═══════════════════════════════════════════════════════════════════════════════

1. Database: PDO with prepared statements (SQL injection protection)
2. API: Input validation and type checking
3. Headers: Content-Type and CORS headers
4. Error Handling: Try-catch blocks with user-friendly messages

⚠️  TODO for Production:
    - Add user authentication
    - Encrypt access tokens
    - Implement HTTPS only
    - Add CSRF protection
    - Rate limiting on API endpoints
    - Input sanitization


📈 FUTURE INTEGRATION
═══════════════════════════════════════════════════════════════════════════════

                    ┌──────────────────────────┐
                    │   Church Management      │
                    │        System            │
                    └────────────┬─────────────┘
                                 │
        ┌────────────────────────┼────────────────────────┐
        │                        │                        │
┌───────▼────────┐   ┌──────────▼─────────┐   ┌─────────▼────────┐
│  Facebook API  │   │   Instagram API    │   │   Twitter API    │
│  Graph API     │   │   Basic Display    │   │   API v2         │
└───────┬────────┘   └──────────┬─────────┘   └─────────┬────────┘
        │                        │                        │
        └────────────────────────┼────────────────────────┘
                                 │
                    ┌────────────▼─────────────┐
                    │   Social Media API       │
                    │   (Your Backend)         │
                    └──────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
  This architecture provides a scalable foundation for social media tracking!
═══════════════════════════════════════════════════════════════════════════════
